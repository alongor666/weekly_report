# 赔付率趋势追踪器 V2.0 - 设计文档

**创建日期**: 2024-11-04
**最后更新**: 2024-11-04 (V2.0 重大升级)
**设计目标**: 基于多周累计数据追踪赔付率问题演变,生成麦肯锡级专业分析报告
**技能名称**: `insurance-loss-trend-tracker`

---

## 版本更新记录

### V2.0 (2024-11-04) - 重大升级

**核心改进**:
1. ✅ 智能周期管理(自动推断 + 手动覆盖)
2. ✅ 当周发生值计算(差值法,容错处理)
3. ✅ 多指标因果分解(出险率×案均赔款×案件数)
4. ✅ 异常波动检测(单周暴涨/连续恶化/趋势反转)
5. ✅ 麦肯锡级报告(金字塔原理、So What、可落地建议)

**用户反馈驱动**:
- 需求1: 用户需要指定分析周期 → 实现混合周期管理
- 需求2: CSV是累计数据,需要计算当周值 → 实现差值法计算
- 需求3: 新能源货车专项分析 → 拆分为独立技能(待开发)
- 需求4: 下钻时看多个指标 → 增加出险率、案均赔款、案件数
- 需求5: 报告要达到麦肯锡+经营大师水平 → 应用5大原则

---

## 一、设计概览

### 核心目标
基于多周累计数据追踪赔付率问题演变,通过**当周发生值计算**和**3层渐进式下钻**定位核心问题,生成**麦肯锡级专业分析报告**。

### 架构定位
- **输入**: 多周CSV数据文件(可配置周期,默认5周)
- **数据特征**: 年度累计数据,需计算当周发生值
- **处理**: 独立运行,不修改现有周报系统
- **输出**: 独立报告 `赔付率问题演变追踪报告_第XX周.md`

### 与现有技能的关系
- **复用** `insurance-data-loader` - 数据加载逻辑(需扩展前一周)
- **复用** `insurance-kpi-calculator` - 赔付率计算方法(需增加当周值)
- **独立** 不影响现有周报生成流程
- **并行** 与周报系统并行运行,互不干扰

---

## 二、三层下钻逻辑

### Layer 1: 机构维度 → TOP3问题机构

**筛选标准**: 综合趋势评分(组合评分)

```python
# 1. 当前赔付率状态评分
状态分 = {
    < 60%: 95-100 (优秀),
    60-70%: 86-94 (良好),
    70-75%: 70-85 (中等),
    75-80%: 40-69 (预警),
    > 80%: 0-39 (高危)
}

# 2. 变化幅度评分
幅度分 = {
    下降 > 5%: +20,
    下降 0-5%: +10,
    持平: 0,
    上升 0-5%: -10,
    上升 5-10%: -20,
    上升 > 10%: -30
}

# 3. 连续恶化惩罚
连续分 = -10 × 连续恶化周数  # 最多-30

# 综合趋势评分
趋势分 = 状态分 + 幅度分 + 连续分
```

**排序方式**: 按趋势分从低到高,取最低的TOP3
**终止条件**: 赔付率 < 60%(优秀)的机构不纳入候选

---

### Layer 2: 业务类型维度 → 每个问题机构的TOP3问题业务类型

**筛选标准**: 影响度(赔付率 × 保费占比)

```python
影响度 = 当前周赔付率 × (业务类型保费 / 机构保费) × 100
```

**排序方式**: 按影响度从高到低,取TOP3
**终止条件**: 保费占比 < 1%的业务类型跳过

---

### Layer 3: 险别组合维度 → 每个问题业务类型的最差险别

**筛选标准**: 综合趋势评分(与Layer 1相同逻辑)

```python
趋势分 = 状态分 + 幅度分 + 连续分
```

**排序方式**: 按趋势分从低到高,取最低的1个险别
**终止条件**: 保费占比 < 1%标记为"样本量不足"

---

## 三、趋势判断算法

### 赔付率状态等级(严格按照率值指标配置)

| 赔付率范围 | 等级 | 色彩 | 状态评分 |
|-----------|------|------|----------|
| < 60% | 优秀 | 🟢 | 95-100 |
| 60-70% | 良好 | 🟢 | 86-94 |
| 70-75% | 中等 | 🔵 | 70-85 |
| 75-80% | 预警 | 🟡 | 40-69 |
| > 80% | 高危 | 🔴 | 0-39 |

### 趋势标签生成规则

```python
if 连续恶化周数 >= 3 and 当前赔付率 > 80%:
    标签 = "🔴 严重恶化"
elif 连续恶化周数 >= 2 and 当前赔付率 > 75%:
    标签 = "🟠 持续恶化"
elif 当前赔付率 > 80%:
    标签 = "🟠 高危波动"
elif 5周整体变化 > 10:
    标签 = "🟡 显著上升"
elif 5周整体变化 > 0:
    标签 = "🟡 缓慢上升"
else:
    标签 = "🟢 趋于改善"
```

---

## 四、输出格式设计

### 报告文件命名
```
赔付率趋势分析报告_第44周.md
```

### 报告结构(自然语言 + 富文本)

#### 标题与元信息
```markdown
# 赔付率趋势分析报告 - 第44周

从第40周到第44周的5周时间里,我们追踪了12个三级机构的赔付率演变轨迹。本报告聚焦于问题最严重、影响最大的机构,并深入到具体业务类型和险别组合,帮助您快速定位需要关注的核心问题。

**分析周期**: 第40周 → 第44周 (5周数据)
**报告生成时间**: 2024年11月4日 14:30
```

#### 问题机构叙述(自然语言)
```markdown
## 📍 问题机构 #1: 高新

高新机构的赔付率在这5周内呈现**严重恶化**趋势。从第40周的71.7%一路攀升至第44周的84.2%,累计上升了12.5个百分点,并且连续4周持续恶化,目前已进入🔴**高危区间**。

**5周赔付率走势**:
- **第40周**: 71.7% (🔵 中等)
- **第41周**: 74.3% (🟡 预警) ↑ +2.6%
- **第42周**: 77.8% (🟡 预警) ↑ +3.5%
- **第43周**: 81.5% (🔴 高危) ↑ +3.7%
- **第44周**: 84.2% (🔴 高危) ↑ +2.7%

从中等状态快速恶化到高危,这种持续上升的态势需要立即关注。
```

#### 业务类型分析(富文本 + 自然语言)
```markdown
### 🔍 深入业务类型层面

在高新机构的所有业务中,**非营业客车旧车非过户**是影响最大的问题业务。

**为什么说影响最大?**
- 这个业务类型的赔付率高达**84.4%**
- 占用了高新机构**65.5%的保费**(约1,519万元)
- 影响度得分: **55.4** = 84.4% × 65.5%

这意味着,高新机构超过一半的保费都集中在这个高赔付业务上,风险高度集中。

**这个业务的5周演变**:
- 第40周: 72.1% → 第44周: 84.4% (上升12.3%)
- 趋势: 连续4周上升,无改善迹象
```

#### 险别组合诊断(问题定位)
```markdown
### 🎯 问题的根源在哪里?

在"非营业客车旧车非过户"业务中,**主全险**是赔付率最高且恶化最严重的险别组合。

**主全险的5周表现**:
```
周次     第40周   第41周   第42周   第43周   第44周
赔付率   85.2%    88.1%    90.5%    92.3%    93.8%
保费占比 87.2%    88.5%    89.1%    90.2%    91.4%
状态     🔴高危   🔴高危   🔴高危   🔴高危   🔴高危
```

**关键发现**:
1. 赔付率从85.2%恶化到93.8%,上升了8.6个百分点
2. 保费占比同步上升,从87.2%增至91.4%
3. 连续5周都处于高危状态,且持续恶化
4. 这个险别组合占据了该业务类型超过90%的保费

**结论**: 高新机构的赔付率问题,核心根源在于"非营业客车旧车非过户 + 主全险"这个组合。该组合不仅赔付率极高(93.8%),而且业务规模大(占机构总保费约60%),同时趋势持续恶化,需要立即采取措施。
```

#### 总结与建议
```markdown
## 💡 核心洞察

### 三大问题焦点

1. **高新机构 - 非营业客车旧车非过户 - 主全险**
   - 当前赔付率: 93.8% (🔴严重恶化)
   - 影响范围: 占机构总保费约60%
   - 风险等级: ⚠️ 最高优先级

2. **武侯机构 - 营业客车旧车非过户 - 主全险**
   - 当前赔付率: 87.2% (🟠持续恶化)
   - 影响范围: 占机构总保费约45%
   - 风险等级: ⚠️ 高优先级

3. **金牛机构 - 特种车旧车非过户 - 交三**
   - 当前赔付率: 78.5% (🟡波动)
   - 影响范围: 占机构总保费约32%
   - 风险等级: ⚠️ 中优先级

### 建议行动

- **立即**: 暂停或收紧高新机构的"非营业客车旧车非过户+主全险"承保政策
- **本周内**: 组织高新、武侯机构的业务复盘会议,分析高赔原因
- **持续监控**: 对这3个问题组合进行每日赔付率监控,设置预警线

---

*本报告由 insurance-loss-trend-tracker 技能自动生成*
```

---

## 五、实现要点

### 数据准备
- 加载5周完整数据(第40-44周)
- 按年度分组处理(2024/2025)
- 过滤本部数据

### 计算流程
1. 计算每个层级的5周赔付率序列
2. 计算趋势评分/影响度
3. 按层级筛选TOP对象
4. 生成自然语言描述

### 输出特点
- 使用自然语言叙述,而非表格堆砌
- 富文本格式(emoji、颜色标签、加粗强调)
- 每个层级都解释"为什么"这个对象是问题
- 提供具体的业务洞察和建议

---

## 六、与现有技能的差异

| 维度 | 现有周报(org-dimension-drilldown) | 趋势追踪器(loss-trend-tracker) |
|------|--------------------------------|-------------------------------|
| 时间视角 | 单周快照 | 5周演变 |
| 筛选标准 | 严重度分数 | Layer1/3用趋势分,Layer2用影响度 |
| 输出重点 | 诊断当前问题 | 追踪问题演变 |
| 叙述风格 | 结构化指标 | 自然语言+业务洞察 |
| 目标受众 | 所有机构全覆盖 | TOP3问题机构聚焦 |

---

**设计完成,准备进入实现阶段。**
